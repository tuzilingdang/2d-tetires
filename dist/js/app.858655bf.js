(function(t){function s(s){for(var i,o,r=s[0],c=s[1],l=s[2],u=0,p=[];u<r.length;u++)o=r[u],n[o]&&p.push(n[o][0]),n[o]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);h&&h(s);while(p.length)p.shift()();return a.push.apply(a,l||[]),e()}function e(){for(var t,s=0;s<a.length;s++){for(var e=a[s],i=!0,r=1;r<e.length;r++){var c=e[r];0!==n[c]&&(i=!1)}i&&(a.splice(s--,1),t=o(o.s=e[0]))}return t}var i={},n={app:0},a=[];function o(s){if(i[s])return i[s].exports;var e=i[s]={i:s,l:!1,exports:{}};return t[s].call(e.exports,e,e.exports,o),e.l=!0,e.exports}o.m=t,o.c=i,o.d=function(t,s,e){o.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:e})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,s){if(1&s&&(t=o(t)),8&s)return t;if(4&s&&"object"===typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(o.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var i in t)o.d(e,i,function(s){return t[s]}.bind(null,i));return e},o.n=function(t){var s=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(s,"a",s),s},o.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=s,r=r.slice();for(var l=0;l<r.length;l++)s(r[l]);var h=c;a.push([0,"chunk-vendors"]),e()})({0:function(t,s,e){t.exports=e("56d7")},1009:function(t,s,e){},2472:function(t,s,e){"use strict";var i=e("b7cc"),n=e.n(i);n.a},"269d":function(t,s,e){},"343d":function(t,s,e){"use strict";var i=e("269d"),n=e.n(i);n.a},"56d7":function(t,s,e){"use strict";e.r(s);e("f4b1"),e("a2f3"),e("e468");var i=e("3a00"),n=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{attrs:{id:"app"}},[e("div",{attrs:{id:"game"}},[e("Screen"),e("KeyBoard")],1)])},a=[],o=function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"screen",class:t.isGameOn?"on":"off"},[i("div",{staticClass:"screen-grid"},[t.gameOver?i("img",{staticClass:"game_over_img",attrs:{src:e("ed06"),alt:""}}):t._e(),!t.isGameOn||t.isStart||t.gameOver?t._e():i("img",{staticClass:"game_over_img",attrs:{src:e("a588"),alt:""}}),t.gameOver?i("i",{staticClass:"game_over"}):t._e(),i("div",{staticClass:"screen-grid-area",class:t.isGameOn?"":"hidden"},t._l(t.columnNum*t.rowNum,function(s){return i("div",{key:s,staticClass:"square",class:!t.gameOver&&t.matrix[parseInt((s-1)/t.columnNum)][(s-1)%t.columnNum]?"black":"",attrs:{id:parseInt((s-1)/t.columnNum)+"-"+(s-1)%t.columnNum}},[i("div",{staticClass:"square-inner"})])}),0)]),i("div",{staticClass:"screen-status"},[t.isGameOn?i("div",{staticClass:"screen-status-next screen-status-item"},[i("span",[t._v("NEXT")]),i("div",{staticClass:"screen-status-nextshape-area "},t._l(8,function(s){return i("div",{key:s,staticClass:"square",class:!t.gameOver&&t.nextShapeMat[parseInt((s-1)/4)][(s-1)%4]?"black":"",attrs:{id:parseInt((s-1)/4)+"-"+(s-1)%4}},[i("div",{staticClass:"square-inner"})])}),0)]):t._e(),t.isGameOn?i("div",{staticClass:"screen-status-grade screen-status-item"},[i("span",[t._v("SCORE")]),i("p",[t._v(t._s(t.score))])]):t._e(),t.isGameOn?i("div",{staticClass:"screen-status-level screen-status-item"},[i("span",[t._v("LEVEL")]),i("p",[t._v(t._s(t.level))])]):t._e(),t.isGameOn?i("div",{staticClass:"screen-status-gamestatus screen-status-item"},[i("span",[t._v("STATUS")]),i("p",[t._v(t._s(this.isStart?this.isPause?"PAUSE":"START":"READY"))])]):t._e(),t.isGameOn?i("div",{staticClass:"screen-status-music screen-status-item"},[i("div",{staticClass:"sound",class:t.isSoundOn?"sound_on":"sound_off"})]):t._e()])])},r=[],c=e("b00f"),l=e("e7af"),h=(e("8c88"),e("9152")),u=e("3b60"),p={J:[[0,0,1],[1,1,1]],L:[[1,0,0],[1,1,1]],I:[[1,1,1,1]],Z:[[1,1,0],[0,1,1]],O:[[1,1],[1,1]],S:[[0,1,1],[1,1,0]],T:[[1,1,1],[0,1,0]]},f=["J","L","I","Z","O","S","T"],m=function(){function t(s){if(Object(h["a"])(this,t),s)switch(this.type=s,this.shape=d(p[s]),s){case"L":case"J":case"Z":case"S":case"T":this.pos={x:-1,y:4,accRows:0};break;case"I":case"O":this.pos={x:-1,y:5,accRows:0};break;default:break}}return Object(u["a"])(t,[{key:"left",value:function(t){if(this.pos.y-1<0)return!1;for(var s=this.pos.x;s<this.pos.x+this.shape.length;s++)if(1==t[s][this.pos.y-1])return!1;this.pos.y--;for(var e=0;e<this.shape.length;e++)t[this.pos.x+e]&&t[this.pos.x+e].splice(this.pos.y+this.shape[0].length,1,0);for(var i=0;i<this.shape.length;i++)for(var n=0;n<this.shape[i].length;n++)t[this.pos.x+i]&&t[this.pos.x+i].splice(this.pos.y+n,1,this.shape[i][n]);return!0}},{key:"right",value:function(t){if(this.pos.y+1>t[0].length-this.shape[0].length)return!1;for(var s=this.pos.x;s<this.pos.x+this.shape.length;s++)if(1==t[s][this.pos.y+this.shape[0].length+1])return!1;this.pos.y++;for(var e=0;e<this.shape.length;e++)t[this.pos.x+e]&&t[this.pos.x+e].splice(this.pos.y-1,1,0);for(var i=0;i<this.shape.length;i++)for(var n=0;n<this.shape[i].length;n++)t[this.pos.x+i]&&t[this.pos.x+i].splice(this.pos.y+n,1,this.shape[i][n]);return!0}},{key:"rotate",value:function(t){for(var s=0;s<this.shape.length;s++)for(var e=0;e<this.shape[s].length;e++)t[this.pos.x+s]&&t[this.pos.x+s].splice(this.pos.y+e,1,0);var i=function(t){if(t||0!=t.length||0!=t[0].length){for(var s=t[0].length,e=t.length,i=s>e?s:e,n=0;n<e/2;n++)for(var a=0;a<s;a++){var o=t[n][a];t[n][a]=t[e-n-1][a],t[e-n-1][a]=o}for(var r=0;r<i;r++){if(r<e)for(var c=r+1;c<i;c++){var l=t[r]&&void 0!=t[r][c]?t[r][c]:null;t[c]&&void 0!=t[c][r]&&(t[r][c]=t[c][r]),(l||0==l)&&(t[c]||(t[c]=Array(s).fill(null)),t[c][r]=l)}s>e&&t[r].splice(e,s-e)}return e>s&&(t=t.slice(0,s)),t}};this.shape=i(this.shape);for(var n=0;n<this.shape.length;n++)for(var a=0;a<this.shape[n].length;a++)t[this.pos.x+n]&&t[this.pos.x+n].splice(this.pos.y+a,1,this.shape[n][a])}},{key:"down",value:function(t,s,e){for(var i=this.shape.length,n=this.shape[0].length,a=this.shape,o=this.pos.y,r=t[0].length,c=[],l="",h=0;h<n;h++){var u=this.pos.x+this.shape.length>=t.length,p=t[this.pos.x+this.shape.length]&&t[this.pos.x+this.shape.length][this.pos.y+h]&&this.shape[i-1][h];if(u||p){for(var f=0;f<i;f++)if(this.pos.x+f>-1){var m=t[this.pos.x+f]&&t[this.pos.x+f].filter(function(t){return 1==t});m.length==r&&e.push(this.pos.x+f)}l=p?"blockCrash":"attatchBottom"}}if(l){for(var v=0;v<n;v++){for(var d=0;d<i;d++)!c[v]&&a[d][v]&&(c[v]=i-d);s[o+v]="blockCrash"==l?t.length-this.pos.x-i+c[v]:s[o+v]+c[v]}return!1}if(this.pos.x++,this.pos.x-1>=0)for(var x=0;x<this.shape[0].length;x++)t[this.pos.x-1].splice(this.pos.y+x,1,0);for(var g=0;g<this.shape.length;g++)for(var w=0;w<this.shape[g].length;w++){var O=g==this.shape.length-1?this.shape[g][w]||t[this.pos.x+g][this.pos.y+w]:this.shape[g][w];t[this.pos.x+g]&&t[this.pos.x+g].splice(this.pos.y+w,1,O)}return!0}},{key:"fall",value:function(t,s,e){var i=this.shape.length,n=this.shape[0].length,a=this.shape,o=this.pos.x,r=this.pos.y,l=t[0].length,h=s.slice(this.pos.y,this.pos.y+this.shape[0].length),u=Math.max.apply(Math,Object(c["a"])(h));if(u>t.length)return!1;var p=function s(e,o){for(var c=o,l=i-1;l>=0;l--){for(var h=0;h<n;h++)if(a[l][h]&&t[e]&&t[e][r+h]){c=e-l-1;break}if(c!=o)break}return c==o&&e<=t.length-1?s(++e,c):c!=o?c:e-i};this.pos.x=p(t.length-u-1,this.pos.x);for(var f=0;f<i;f++){for(var m=0;m<n;m++)t[this.pos.x+f]&&t[this.pos.x+f][r+m]||t[this.pos.x+f]&&t[this.pos.x+f].splice(r+m,1,a[f][m]),t[o+f]&&t[o+f].splice(r+m,1,0),0==f&&(s[r+m]=a[f][m]?t.length-this.pos.x:t.length-this.pos.x-1);var v=t[this.pos.x+f]&&t[this.pos.x+f].filter(function(t){return 1==t});v.length==l&&e.push(this.pos.x+f)}return!0}},{key:"shapeWidth",get:function(){return this.shape[0].length}},{key:"shapeHeight",get:function(){return this.shape.length}}]),t}(),v=m;function d(t){for(var s=[],e=0,i=t.length;e<i;e++)t[e]instanceof Array?s[e]=d(t[e]):s[e]=t[e];return s}e("7847");i["a"].use(l["a"]);var x=["SIMPLE","MIDDLE","HARD"],g=[1e3,500,100],w={isGameOn:!1,isStart:!1,isPause:!1,isSoundOn:!0,gameOver:!1,score:0,level:"SIMPLE",speed:1e3,columnNum:12,rowNum:22,matrix:[],nextShapeMat:[],showNextBlock:!1,accRowsList:Array(12).fill(0),accMax:[],curBlock:{},nextBlock:{},clearRows:[],clearFlag:!1,interval:{}},O=new l["a"].Store({state:w,mutations:{on:function(t){t.isGameOn=!0;for(var s=0;s<t.rowNum;s++)for(var e=0;e<t.columnNum;e++)t.matrix[s].splice(e,1,0);for(var i=0;i<2;i++)for(var n=0;n<3;n++)t.nextShapeMat[i].splice(n,1,0)},off:function(t){t.isGameOn=!1,t.isStart=!1,t.isPause=!1,t.gameOver=!1,t.showNextBlock=!1,t.accRowsList=Array(12).fill(0),t.accMax=[],t.curBlock={},t.clearRows=[],t.clearFlag=!1,clearInterval(t.interval)},reset:function(t){t.isStart=!1,t.isPause=!1,t.gameOver=!1,t.showNextBlock=!1,t.accRowsList=Array(12).fill(0),t.accMax=[],t.curBlock={},t.clearRows=[],t.clearFlag=!1,clearInterval(t.interval);for(var s=0;s<t.rowNum;s++)for(var e=0;e<t.columnNum;e++)t.matrix[s].splice(e,1,0);for(var i=0;i<2;i++)for(var n=0;n<3;n++)t.nextShapeMat[i].splice(n,1,0)},startGame:function(t,s){t.isStart=!0,t.curBlock=s.block,t.showNextBlock=!1},pause:function(t){t.isPause=!0,clearInterval(t.interval)},stopPause:function(t){t.isPause=!1},left:function(t){t.curBlock.left(t.matrix)},right:function(t){t.curBlock.right(t.matrix)},rotate:function(t){t.curBlock.rotate(t.matrix)},fall:function(t,s){t.curBlock.fall(t.matrix,s.accRowsList,t.clearRows)&&(0==t.clearRows.length&&(t.showNextBlock=!0),0!=t.clearRows.length&&(t.clearFlag=!0))},down:function(t){t.interval=setInterval(function(){if(!t.curBlock.down(t.matrix,t.accRowsList,t.clearRows)){clearInterval(t.interval);var s=Math.max.apply(Math,Object(c["a"])(t.accRowsList));s>t.matrix&&this.gameOver(),0!=t.clearRows.length&&(t.clearFlag=!0),t.showNextBlock=!0}},t.speed)},stopDown:function(t){clearInterval(t.interval)},soundOn:function(t){t.isSoundOn=!0},soundOff:function(t){t.isSoundOn=!1},setCurBlock:function(t){t.curBlock=t.nextBlock,t.showNextBlock=!1},setNextBlock:function(t,s){if(t.nextBlock=s.block,t.nextBlock.shape)for(var e=0;e<2;e++)for(var i=0;i<4;i++)t.nextShapeMat[e][i]=t.nextBlock.shape[e]&&t.nextBlock.shape[e][i]},gameOver:function(t){t.gameOver=!0,t.isStart=!1},clear:function(t){var s=t.accRowsList,e=t.matrix,i=t.clearRows,n=i.length,a=Math.max.apply(Math,Object(c["a"])(s)),o=e[0].length,r=e.length;i.forEach(function(t){for(var s=t;s>=r-a&&s<=r-1;s--){var i;(i=e[s]).splice.apply(i,[0,o].concat(Object(c["a"])(e[s-1])))}}),t.accRowsList=s.map(function(t){return t-i.length});var l=1==n?10:2==n?30:3==n?60:4==n?100:0;t.score+=l,t.clearRows=[],t.clearFlag=!1},setLevel:function(t,s){t.level=x[s.idx],t.speed=g[s.idx]}}}),y=window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.oAudioContext||window.msAudioContext,S={},k={data:!!y&&-1!==location.protocol.indexOf("http")};function b(){return new Promise(function(t,s){var e={},i=new y,n=new XMLHttpRequest,a="https://raw.githubusercontent.com/tuzilingdang/2d-tetris/master/src/assets/tetris-music_lite.mp3";n.open("GET",a,!0),n.responseType="arraybuffer",n.onload=function(){i.decodeAudioData(n.response,function(s){var n=function(){var t=i.createBufferSource();return t.buffer=s,t.connect(i.destination),t};e.on=function(){O.state.isSoundOn&&n().start(0,0,2.1)},e.gameStart=function(){O.state.isSoundOn&&n().start(0,8.15,.7)},e.pause=function(){O.state.isSoundOn&&n().start(0,7.5,.4)},e.start=function(){O.state.isSoundOn&&n().start(0,6.6,.4)},e.reset=function(){O.state.isSoundOn&&n().start(0,0,2.1)},e.clear=function(){O.state.isSoundOn&&n().start(0,2.1,1.4)},e.fall=function(){O.state.isSoundOn&&n().start(0,3.1,.5)},e.gameOver=function(){O.state.isSoundOn&&n().start(0,4.7,2.7)},e.rotate=function(){O.state.isSoundOn&&n().start(0,4.6,.6)},e.move=function(){O.state.isSoundOn&&n().start(0,3.8,.4)},t(e)},function(t){window.console&&window.console.error&&(window.console.error("音频文件读取错误",t),k.data=!1,s(t))})},n.send()})}b().then(function(t){S=t});var _={name:"Screen",data:function(){return{d1_matrix:[0,0,0,0]}},computed:Object(l["b"])(["isGameOn","isSoundOn","isPause","isStart","score","level","columnNum","rowNum","matrix","nextShapeMat","showNextBlock","accRowsList","gameOver","clearFlag"]),watch:{showNextBlock:function(t){t&&this.initShowNextBlock()},clearFlag:function(t){var s=this;t&&(this.stopDown(),setTimeout(function(){s.clearRows(),s.initShowNextBlock()},1e3))}},created:function(){this.init()},methods:{init:function(){this.initMatrix(),this.initNextShapeMat()},getNextBlock:function(){var t=this.getRandomBlock();this.$store.commit({type:"setNextBlock",block:t})},initShowNextBlock:function(){var t=Math.max.apply(Math,Object(c["a"])(this.accRowsList));if(t>=this.rowNum)return this.isSoundOn&&S&&S.gameOver(),void this.$store.commit("gameOver");this.$store.commit({type:"setCurBlock"}),this.getNextBlock(),this.$store.commit({type:"down"})},initMatrix:function(){for(var t=0;t<this.rowNum;t++){this.$set(this.matrix,t,new Array);for(var s=0;s<this.columnNum;s++)this.$set(this.matrix[t],s,0)}},initNextShapeMat:function(){for(var t=0;t<2;t++){this.$set(this.nextShapeMat,t,new Array);for(var s=0;s<3;s++)this.$set(this.nextShapeMat[t],s,0)}},getRandomBlock:function(){var t=Math.floor(Math.random()*f.length),s=f[t];return new v(s)},clearRows:function(){this.$store.commit({type:"clear"})},stopDown:function(){this.$store.commit({type:"stopDown"})}}},C=_,B=(e("2472"),e("048f")),N=Object(B["a"])(C,o,r,!1,null,null,null);N.options.__file="Screen.vue";var R=N.exports,$=function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"keyboard"},[e("div",{staticClass:"top-btn"},[e("div",{staticClass:"top-btn-item",on:{click:t.reset}},[e("span",{staticClass:"top-btn-item-txt"},[t._v("RESET")])]),e("div",{staticClass:"top-btn-item",on:{click:t.pauseAndStart}},[e("span",{staticClass:"top-btn-item-txt"},[t._v("P/S")])]),e("div",{staticClass:"top-btn-item",on:{click:t.soundControl}},[e("span",{staticClass:"top-btn-item-txt"},[t._v("SOUND")])]),e("div",{staticClass:"top-btn-item",on:{click:t.onAndOff}},[e("span",{staticClass:"top-btn-item-txt"},[t._v("ON/OFF")])])]),e("div",{staticClass:"bottom-btn"},[e("div",{staticClass:"bottom-btn-arrows"},[e("div",{staticClass:"left",on:{click:t.left}}),e("div",{staticClass:"right",on:{click:t.right}}),e("div",{staticClass:"up",on:{click:t.rotate}}),e("div",{staticClass:"down",on:{click:t.fall}})]),e("div",{staticClass:"bottom-btn-circle"},[e("div",{staticClass:"bottom-btn-circle-start",on:{click:t.rotate}}),t._m(0)])])])},M=[function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("span",[e("strong",[t._v("ROTATE")])])}],P={name:"KeyBoard",data:function(){return{levelIdx:0}},computed:Object(l["b"])(["isGameOn","isStart","isPause","isSoundOn","gameOver","columnNum","rowNum","matrix","accRowsList"]),methods:{onAndOff:function(){if(!this.isGameOn)return this.isSoundOn&&S&&S.on(),void this.$store.commit({type:"on"});this.$store.commit({type:"off"})},pauseAndStart:function(){this.isGameOn&&!this.gameOver&&(!this.isStart||this.isPause?(this.isSoundOn&&S&&S.start(),this.start()):this.isStart&&(this.isSoundOn&&S&&S.pause(),this.pause()))},start:function(){this.isGameOn&&(this.isStart||(this.isSoundOn&&S&&S.gameStart(),this.startGame()),this.isStart&&this.isPause&&(this.$store.commit({type:"stopPause"}),this.$store.commit({type:"down"})))},reset:function(){this.isGameOn&&(this.isSoundOn&&S&&S.reset(),this.$store.commit({type:"reset"}))},startGame:function(){var t=this.getRandomBlock(),s=this.getRandomBlock();!this.isStart&&this.$store.commit({type:"startGame",block:t}),this.$store.commit({type:"setNextBlock",block:s}),this.$store.commit({type:"down"})},left:function(){this.isPause||this.gameOver||(this.isSoundOn&&S&&S.move(),this.isStart?(this.$store.commit({type:"stopDown"}),this.$store.commit({type:"left"}),this.$store.commit({type:"down"})):this.levelIdx>0&&this.$store.commit({type:"setLevel",idx:--this.levelIdx}))},right:function(){this.isPause||this.gameOver||(this.isSoundOn&&S&&S.move(),this.isStart?(this.$store.commit({type:"stopDown"}),this.$store.commit({type:"right"}),this.$store.commit({type:"down"})):this.levelIdx>=0&&this.levelIdx<2&&this.$store.commit({type:"setLevel",idx:++this.levelIdx}))},rotate:function(){!this.isStart||this.isPause||this.gameOver||(this.isSoundOn&&S&&S.rotate(),this.$store.commit({type:"stopDown"}),this.$store.commit({type:"rotate"}),this.$store.commit({type:"down"}))},fall:function(){this.isStart&&!this.isPause&&(this.isSoundOn&&S&&S.fall(),this.$store.commit({type:"stopDown"}),this.$store.commit({type:"fall",accRowsList:this.accRowsList}))},pause:function(){this.isStart&&!this.isPause&&this.$store.commit({type:"pause"})},soundControl:function(){this.isSoundOn?this.isSoundOn&&this.$store.commit({type:"soundOff"}):this.$store.commit({type:"soundOn"})},getRandomBlock:function(){var t=Math.floor(Math.random()*f.length),s=f[t];return new v(s)}}},L=P,A=(e("343d"),Object(B["a"])(L,$,M,!1,null,null,null));A.options.__file="KeyBoard.vue";var G=A.exports,I={name:"app",components:{Screen:R,KeyBoard:G}},j=I,E=(e("7c55"),Object(B["a"])(j,n,a,!1,null,null,null));E.options.__file="App.vue";var T=E.exports;i["a"].config.productionTip=!1,new i["a"]({render:function(t){return t(T)},store:O}).$mount("#app")},"7c55":function(t,s,e){"use strict";var i=e("1009"),n=e.n(i);n.a},a588:function(t,s,e){t.exports=e.p+"img/wilson_pixel.cd9ef8ab.png"},b7cc:function(t,s,e){},ed06:function(t,s,e){t.exports=e.p+"img/wilson_pixel_game_over.9eae6230.png"}});
//# sourceMappingURL=app.858655bf.js.map